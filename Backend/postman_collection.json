{
  "info": {
    "name": "PharmEasy Authentication API",
    "description": "Complete authentication flow testing collection",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "1. Get Roles",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": {
          "raw": "{{base_url}}/roles",
          "host": ["{{base_url}}"],
          "path": ["roles"]
        },
        "description": "Get all available roles (PATIENT, PHARMACY_ADMIN, SYSTEM_ADMIN)"
      },
      "response": []
    },
    {
      "name": "2. Register User",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"patient@example.com\",\n  \"name\": \"John Doe\",\n  \"password\": \"SecurePass@123\",\n  \"phone\": \"+1234567890\",\n  \"roleId\": \"cmjqo6wji0000y0bg5ahqehkh\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/auth/register",
          "host": ["{{base_url}}"],
          "path": ["auth", "register"]
        },
        "description": "Register a new user. Password must: 8+ chars, uppercase, lowercase, number, special char"
      },
      "response": []
    },
    {
      "name": "3. Resend OTP",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"patient@example.com\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/auth/resend-otp",
          "host": ["{{base_url}}"],
          "path": ["auth", "resend-otp"]
        },
        "description": "Resend OTP if user didn't receive it"
      },
      "response": []
    },
    {
      "name": "4. Verify OTP",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"userId\": \"user_id_from_registration\",\n  \"otp\": \"123456\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/auth/verify-otp",
          "host": ["{{base_url}}"],
          "path": ["auth", "verify-otp"]
        },
        "description": "Verify OTP sent to user email. OTP is 6 digits and expires in 10 minutes"
      },
      "response": []
    },
    {
      "name": "5. Login",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"patient@example.com\",\n  \"password\": \"SecurePass@123\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/auth/login",
          "host": ["{{base_url}}"],
          "path": ["auth", "login"]
        },
        "description": "Login user. Returns accessToken (15 min) and refreshToken (7 days)"
      },
      "response": []
    },
    {
      "name": "6. Get Current User Profile",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{access_token}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": {
          "raw": "{{base_url}}/auth/me",
          "host": ["{{base_url}}"],
          "path": ["auth", "me"]
        },
        "description": "Get current authenticated user profile. Requires valid accessToken"
      },
      "response": []
    },
    {
      "name": "7. Refresh Access Token",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{access_token}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"refreshToken\": \"refresh_token_from_login\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/auth/refresh",
          "host": ["{{base_url}}"],
          "path": ["auth", "refresh"]
        },
        "description": "Get new accessToken using refreshToken. Implements token rotation"
      },
      "response": []
    },
    {
      "name": "8. Forgot Password",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"patient@example.com\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/auth/forgot-password",
          "host": ["{{base_url}}"],
          "path": ["auth", "forgot-password"]
        },
        "description": "Request password reset link. Link sent via email (1 hour validity)"
      },
      "response": []
    },
    {
      "name": "9. Reset Password",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"token\": \"reset_token_from_email\",\n  \"newPassword\": \"NewSecurePass@456\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/auth/reset-password",
          "host": ["{{base_url}}"],
          "path": ["auth", "reset-password"]
        },
        "description": "Reset password using token from email. Single-use token"
      },
      "response": []
    },
    {
      "name": "10. Logout",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{access_token}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": {
          "raw": "{{base_url}}/auth/logout",
          "host": ["{{base_url}}"],
          "path": ["auth", "logout"]
        },
        "description": "Logout user and revoke all refresh tokens"
      },
      "response": []
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:5000/api",
      "type": "string"
    },
    {
      "key": "access_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "refresh_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "user_id",
      "value": "",
      "type": "string"
    }
  ]
}
